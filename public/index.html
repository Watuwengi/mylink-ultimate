
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MyLink Ultimate</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <style>
    body{background:#000;color:#0f9;font-family:Arial;text-align:center;padding:20px;margin:0}
    input{width:75%;padding:15px;margin:10px;font-size:18px;border:2px solid #0f9;background:#111;color:#0f9;border-radius:10px}
    button{padding:15px 25px;background:#0f9;color:#000;font-weight:bold;border:none;border-radius:10px;font-size:16px;margin:5px}
    #qrcode{margin:30px auto;width:300px;height:300px;border:5px solid #0f9;border-radius:15px;background:#000}
    #status{color:#0f0;font-size:20px;margin:20px}
    #link{color:#0ff;word-break:break-all;padding:10px;font-size:17px}
  </style>
</head>
<body>
  <h1>MyLink Ultimate</h1>
  <p>Enter Kenyan number (optional for SMS)</p>
  <input id="num" placeholder="0710547624">
  <br>
  <button onclick="generateOnly()">GENERATE QR ONLY</button>
  <button onclick="generateAndSMS()">GENERATE QR + SEND SMS</button>

  <div id="status"></div>
  <div id="qrcode"></div>
  <div id="link"></div>

  <script>
    const baseLink = location.origin + '/phone?t=' + Date.now();

    function generateQR(link) {
      document.getElementById('qrcode').innerHTML = '';
      QRCode.toCanvas(document.getElementById('qrcode'), link, {width: 300, color:{dark:'#0ff', light:'#000'}});
      document.getElementById('link').innerHTML = `<p>Or open manually:</p><a href="${link}">${link}</a>`;
    }

    function generateOnly() {
      document.getElementById('status').innerHTML = 'QR Ready â€” Scan with phone camera!';
      generateQR(baseLink);
    }

    async function generateAndSMS() {
      const num = document.getElementById('num').value.trim();
      if (!num) return alert('Enter your number first!');
      document.getElementById('status').innerHTML = 'Sending SMS + Generating QR...';
      generateQR(baseLink);
      await fetch('/send?target=' + num);
      document.getElementById('status').innerHTML = 'QR Ready + SMS Sent! (check messages)';
    }
  </script>
</body>
</html>
